# 3D objecten

Onderzoeksvraag: *Voor welke soorten objecten en daarmee samenhangende datasets zou deze standaard moeten gelden?*

We kijken naar twee use cases die vooral focussen op de SOLL situatie en antwoord geven op de vraag wat is er nodig aan standaarden om naar die SOLL situatie te komen.

De use cases zijn:

- DTaaS: Digital Twin as a Service. In DTaaS komen diverse use cases aan de orde zoals hittestress en overstroming van steden, waarbij een 3D stadsmodel nodig is om simulaties te kunnen doen. DTaaS maakt gebruik van 3D geo-objecten maar schrijft geen standaard voor. Voor een vergroot gebruik van Digital Twins is een 3D standaard aan te bevelen. Door Digital Twin als usecase te gebruiken versterken we ook de relatie tussen het ZoN Datafundament en het ZoN Digital Twin programma.
- Informatiemodel Geluid. Geluid is bij uitstek een 3D “ding” en heeft ook 3D objecten nodig om binnen de geluidsmodellen te kunnen bepalen welk geluid hoe hard ergens aankomt, gegeven de locatie van de geluidsbron en de fysieke objecten die het geluid onderweg tegenkomt.

## Wat is 3D
In dit document schrijven wij over 3D-objecten. Er zijn verschillende definities van 3D. 

<br>Topologische dimensie:</br> Dit is een nummer dat de orthogonale richtingen beschrijft waar een geometrie zich naar uitstrekt. De topologische dimensie kijkt lokaal naar het object, het beschrijft de hoeveelheid onafhankelijke richtingen die er zijn zonder het object te verlaten. Een punt heeft een topologische dimensie van 0. Een rechte lijn een lengte, maar geen breedte of hoogte. De topologische dimensie van een lijn is 1. Een vlak heeft een topologische dimensie van 2. Een kubus heeft topologische dimensie van 3.   

<br>Coordinaat dimensie:</br> Deze dimensie beschrijft de hoeveelheid onafhankelijke richtingen die de coordinaten hebben waarmee geometrie is opgebouwd. In theorie kan men, door coördinaten uit te breiden, oneindig veel dimensies bereiken. Veel gebruik zijn de dimensies x, y en z. Maar ook de tijdsdimensie (t) en maat (m) dimensie worden vaak gebruikt. 

<br>Ruimtelijke dimensie:</br>
Deze dimensie beschrijft de hoeveelheid onafhankelijke richtingen in de "echte ruimte", die we visueel of fysiek kunnen voorstellen. Dit gaat om de x, y en z dimensie. Dimensies als tijd, maat, druk, temperatuur etc. tellen niet mee.  

De topologische, coordinaat en ruimtelijke dimensies meten elk een ander aspect van een geometrie. 

| Geometrie | Topologische dimensie | Coördinaat- dimensie | Ruimtelijke dimensie | Uitleg | 
| -- | -- | -- | -- | -- | 
| Punt (x,y) | 0D | 2D | 2D | Dit punt strekt zich in 0 richtingen, is beschreven door 2 coördinaten en ligt op een 2D vlak of assenstelsel.  | 
| Lijn (x,y) | 1D | 2D | 2D | Deze lijn strekt zich in 1 richting, is beschreven door 2 coördinaten en ligt op een 2D vlak of assenstelsel. | 
| Vlak (x,y,z) | 2D | 3D | 3D | Dit vlak strekt zich in 2 richtingen, is beschreven door 3 coördinaten en ligt op een 3D vlak of assenstelsel.  | 
| Kubus (x,y,z) | 3D | 3D | 3D | Deze kubus strekt zich in 3 richtingen, is beschreven door 3 coördinaten en ligt op een 3D vlak of assenstelsel.  | 
| Lijn met tijd en maat (x,y,z,t,m) | 1D | 5D | 3D | Deze lijn strekt zich in 1 richting, is beschreven door 5 coördinaten en ligt op een 3D vlak of assenstelsel.  | 
| Punt met een maat (x,y,z,m) | 0D | 4D | 3D | Dit punt strekt zich in 0 richting, is beschreven door 4 coördinaten en ligt op een 3D vlak of assenstelsel.  | 

In dit document focussen wij ons op 3D-objecten waarbij 3D staat voor de ruimtelijke dimensie. 

## Geometrie in 2,5D
Naast de 1D, 2D en 3D ruimtelijke dimensie bestaat er geometrie die men typeert als 2,5D. Hiermee bedoelt men een geometrie die beschreven is door 2 coördinaten, en daarnaast één waarde heeft waarmee de totale geometrie een extra dimensie krijgt. Bijvoorbeeld een vlak geometrie die beschreven is in twee dimensies (x en y) voor alle punten waaruit dit vlak bestaat, kan één hoogte-element als attribuut krijgen waarmee de totale geometrie op hoogte gebracht wordt. Het is daarmee niet mogelijk om de afzonderlijke punten waaruit de geometrie bestaat naar van elkaar afwijkende hoogte te modelleren. Hierom spreekt men ook wel van 2,5D. Dit principe wordt bijvoorbeeld gebruikt in de BGT, waarbij [2D-vlak geometrie](https://docs.geostandaarden.nl/imgeo/catalogus/bgt/#geometrietypen) met het attribuut [relatieveHoogteligging](https://docs.geostandaarden.nl/imgeo/catalogus/bgt/#relatievehoogteligging) op hoogte kan worden gebracht. 

![Verschil tussen de ruimtelijke dimensie 2D, 2,5D en 3D](media/Dimensies.png "Verschil tussen de ruimtelijke dimensie 2D, 2,5D en 3D")

## Topologische relaties 
Een topologische relatie beschrijft hoe objecten ruimtelijk met elkaar verbonden zijn. Ligt iets in, op, naast of over elkaar? Raken objecten elkaar? Of zijn deze gescheiden? 

Om dit geformaliseerd te kunnen duiden en wiskundig te kunnen berekenen zijn standaard topologische modellen beschikbaar. Een belangrijk topologische model dat formeel erkend is door het OGC in de [Simple Feature Access](https://www.ogc.org/standards/sfa/) is het Dimensionally Extended 9–Intersection Model (DE-9IM). 

Het DE-9IM splitst geometrie op in binnen (interior), grens (boundary) en buiten (exterior).

<figure id="Binnen-buiten-grens-van-geometrie">
      <img src="./media/Grens-Binnen-Buiten-Geometrie.png" alt="Binnen, buiten en grens van geometrie" width="700"/>
    <figcaption><a class="self-link" href="#fig-Binnen-buiten-grens-van-geometrie"></bdi></a><span class="fig-title">Binnen, buiten en grens van geometrie</span></figcaption>
</figure>

De topologische relatie tussen twee geometrieën wordt bepaald door te kijken of en hoe grens, binnen en buiten elkaar snijden. Niet of wel, en als wel met welke dimensie. In het DE-9IM-model wordt de topologische relatie bepaald door de 3×3-matrix van intersecties tussen interieur, grens en exterieur.”

<figure id="Intersectie_model_2D">
      <img src="./media/Intersectie_model_2D.png" alt="Intersectie model 2D" width="700"/>
    <figcaption><a class="self-link" href="#fig-Topologische_Relaties_in_2D"></bdi></a><span class="fig-title">Intersectiemodel van twee 2D vlakken</span></figcaption>
</figure>

<figure id="Intersectie_model_3D">
      <img src="./media/Intersectie_model_3D.png" alt="Intersectie model in 3D" width="700"/>
    <figcaption><a class="self-link" href="#fig-Topologische_Relaties_in_3D"></bdi></a><span class="fig-title">Intersectiemodel van 3D volumes</span></figcaption>
</figure>

De patronen van de matrix van de intersecties definiëren onderstaande relaties:  

<figure id="Topologische_Relaties_2D_vlakken">
      <img src="./media/Topologische_relaties_2D_vlakken.png" alt="Topologische relaties in 3D" width="700"/>
    <figcaption><a class="self-link" href="#fig-Topologische_Relaties_in_3D"></bdi></a><span class="fig-title">Topologische relatie van twee vlakken</span></figcaption>
</figure>

Deze relaties zijn formeel gedefinieerd voor 2D‑geometrieën. De implementaties in software volgen dat ook.

Wel is het mogelijk om deze intersectie relaties toe te passen in 3D. Dit kan er als volgt uitzien: 

<figure id="Topologische_Relaties_3D_volumes">
      <img src="./media/Topologische_relaties_3D_volumes.png" alt="Topologische relaties in 3D" width="700"/>
    <figcaption><a class="self-link" href="#fig-Topologische_Relaties_in_3D"></bdi></a><span class="fig-title">Topologische relatie van twee 3D volumes</span></figcaption>
</figure>

De vraag is of er voldoende betekenis te geven is met deze 3D-topologische relaties. 

Onderstaande voorbeelden kennen allen de topologische relatie "Meet (grenst aan)" 

<figure id="Topologische_Relatie_3D_grenst_aan">
      <img src="./media/3D_Topologische_relatie_grenst_aan.png" alt="Topologische relaties 3D grenst aan" width="700"/>
    <figcaption><a class="self-link" href="#fig-Topologische_Relaties_in_3D"></bdi></a><span class="fig-title">Zes voorbeelden van een zelfde topologische relaties "grenst aan"</span></figcaption>
</figure>

<mark> In de software is het volgende beschikbaar. Nog onderzoeken </mark>

[ST_3DIntersects](https://postgis.net/docs/ST_3DIntersects.html)
Zie [PostGIS 3D Functions](https://postgis.net/workshops/postgis-intro/3d.html)

In praktijk wordt het vaak op 3D-gegevens gebruikt door de geometrie in 2D te projecteren, maar dit betekent dat sommige 3D-topologische nuances (zoals “boven/op elkaar” in de Z-richting) niet worden gemodelleerd.

<figure id="3D_vs_2D_geometrie_disjoint_vs_overlap">
      <img src="./media/3D_vs_2D_geometrie_disjoint_vs_overlap.png" alt="3D vs 2D project Disjoint vs Overlap" width="700"/>
    <figcaption><a class="self-link" href="#fig-3D_vs_2D_geometrie_disjoint_vs_overlap"></bdi></a><span class="fig-title">3D vs 2D project Disjoint vs Overlap"</span></figcaption>
</figure>

<mark>De topologische regel in de BGT is dat de vlakken op eenzelfde relatieve hoogteligging niet overlappend mogen zijn. Het moet vlakdekkend zijn. Wat gaat dit in de 3D geometriën betekenen?</mark> 